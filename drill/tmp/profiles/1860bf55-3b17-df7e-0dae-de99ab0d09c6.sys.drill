{"id":{"part1":1756614227459039102,"part2":985970120021838278},"type":1,"start":1738490026950,"end":1738490027554,"query":"SELECT NEARESTDATE(EXTRACT(DAY FROM `date`), 'DAY') AS fcpkv_date, sum(`PM2_5`) AS `SUM(PM2_5)` \nFROM `mongo`.`air_quality`.`daily_averages` \nWHERE EXTRACT(DAY FROM `date`) >= '2025-02-01 00:00:00.000000' AND EXTRACT(DAY FROM `date`) < '2025-02-02 00:00:00.000000' GROUP BY NEARESTDATE(EXTRACT(DAY FROM `date`), 'DAY')\n LIMIT 50000","plan":"00-00    Screen : rowType = RecordType(TIMESTAMP(3) fcpkv_date, ANY SUM(PM2_5)): rowcount = 50000.0, cumulative cost = {156938.75 rows, 365222.5 cpu, 0.0 io, 0.0 network, 3102.0000000000005 memory}, id = 52660\n00-01      Project(fcpkv_date=[$0], SUM(PM2_5)=[$1]) : rowType = RecordType(TIMESTAMP(3) fcpkv_date, ANY SUM(PM2_5)): rowcount = 50000.0, cumulative cost = {151938.75 rows, 360222.5 cpu, 0.0 io, 0.0 network, 3102.0000000000005 memory}, id = 52659\n00-02        SelectionVectorRemover : rowType = RecordType(TIMESTAMP(3) fcpkv_date, ANY SUM(PM2_5)): rowcount = 50000.0, cumulative cost = {101938.75 rows, 260222.5 cpu, 0.0 io, 0.0 network, 3102.0000000000005 memory}, id = 52656\n00-03          Limit(fetch=[50000]) : rowType = RecordType(TIMESTAMP(3) fcpkv_date, ANY SUM(PM2_5)): rowcount = 50000.0, cumulative cost = {51938.75 rows, 210222.5 cpu, 0.0 io, 0.0 network, 3102.0000000000005 memory}, id = 52655\n00-04            HashAgg(group=[{0}], SUM(PM2_5)=[SUM($1)]) : rowType = RecordType(TIMESTAMP(3) fcpkv_date, ANY SUM(PM2_5)): rowcount = 17.625, cumulative cost = {1938.75 rows, 10222.5 cpu, 0.0 io, 0.0 network, 3102.0000000000005 memory}, id = 52654\n00-05              Project(fcpkv_date=[NEARESTDATE(EXTRACT(FLAG(DAY), $0), 'DAY')], PM2_5=[$1]) : rowType = RecordType(TIMESTAMP(3) fcpkv_date, ANY PM2_5): rowcount = 176.25, cumulative cost = {1762.5 rows, 6697.5 cpu, 0.0 io, 0.0 network, 0.0 memory}, id = 52653\n00-06                SelectionVectorRemover : rowType = RecordType(ANY date, ANY PM2_5): rowcount = 176.25, cumulative cost = {1586.25 rows, 5816.25 cpu, 0.0 io, 0.0 network, 0.0 memory}, id = 52652\n00-07                  Filter(condition=[AND(>=(EXTRACT(FLAG(DAY), $0), '2025-02-01 00:00:00.000000'), <(EXTRACT(FLAG(DAY), $0), '2025-02-02 00:00:00.000000'))]) : rowType = RecordType(ANY date, ANY PM2_5): rowcount = 176.25, cumulative cost = {1410.0 rows, 5640.0 cpu, 0.0 io, 0.0 network, 0.0 memory}, id = 52651\n00-08                    Plugin(groupScan=[MongoGroupScan [MongoScanSpec=MongoScanSpec [dbName=\"air_quality\", collectionName=\"daily_averages\", operations=[]], columns=[`date`, `PM2_5`], useAggregate=false]]) : rowType = RecordType(ANY date, ANY PM2_5): rowcount = 705.0, cumulative cost = {705.0 rows, 705.0 cpu, 0.0 io, 0.0 network, 0.0 memory}, id = 52574\n","foreman":{"address":"d801c18dcf88","userPort":31010,"controlPort":31011,"dataPort":31012,"version":"1.21.2","state":0},"state":4,"totalFragments":1,"finishedFragments":0,"fragmentProfile":[{"majorFragmentId":0,"minorFragmentProfile":[{"state":2,"minorFragmentId":0,"operatorProfile":[{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":8,"operatorType":47,"setupNanos":0,"processNanos":225484,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"MONGO_SUB_SCAN"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":7,"operatorType":2,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"FILTER"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":6,"operatorType":14,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"SELECTION_VECTOR_REMOVER"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":5,"operatorType":10,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"PROJECT"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":4,"operatorType":3,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"HASH_AGGREGATE"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":3,"operatorType":7,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"LIMIT"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":2,"operatorType":14,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"SELECTION_VECTOR_REMOVER"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":1,"operatorType":10,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"PROJECT"},{"inputProfile":[{"records":0,"batches":0,"schemas":0}],"operatorId":0,"operatorType":13,"setupNanos":0,"processNanos":0,"peakLocalMemoryAllocated":0,"waitNanos":0,"operatorTypeName":"SCREEN"}],"startTime":1738490027213,"endTime":1738490027225,"memoryUsed":9000000,"maxMemoryUsed":9000000,"endpoint":{"address":"d801c18dcf88","userPort":31010,"controlPort":31011,"dataPort":31012,"version":"1.21.2","state":0},"lastUpdate":1738490027226,"lastProgress":1738490027226}]}],"user":"anonymous","error":"SYSTEM ERROR: Drill Remote Exception\n\n\nPlease, refer to logs for more information.\n","verboseError":"SYSTEM ERROR: Drill Remote Exception\n\n\nPlease, refer to logs for more information.\n\n\n  (java.lang.NumberFormatException) 2025-02-02 00:00:00.000000\n    org.apache.drill.exec.expr.fn.impl.StringFunctionHelpers.nfeL():88\n    org.apache.drill.exec.expr.fn.impl.StringFunctionHelpers.varTypesToLong():59\n    org.apache.drill.exec.test.generated.FiltererGen1071.doSetup():169\n    org.apache.drill.exec.test.generated.FiltererGen1071.setup():55\n    org.apache.drill.exec.physical.impl.filter.FilterRecordBatch.generateSV2Filterer():193\n    org.apache.drill.exec.physical.impl.filter.FilterRecordBatch.setupNewSchema():116\n    org.apache.drill.exec.record.AbstractUnaryRecordBatch.innerNext():92\n    org.apache.drill.exec.record.AbstractRecordBatch.next():160\n    org.apache.drill.exec.record.AbstractRecordBatch.next():109\n    org.apache.drill.exec.record.AbstractRecordBatch.next():101\n    org.apache.drill.exec.record.AbstractUnaryRecordBatch.innerNext():59\n    org.apache.drill.exec.record.AbstractRecordBatch.next():160\n    org.apache.drill.exec.record.AbstractRecordBatch.next():109\n    org.apache.drill.exec.record.AbstractRecordBatch.next():101\n    org.apache.drill.exec.record.AbstractUnaryRecordBatch.innerNext():59\n    org.apache.drill.exec.physical.impl.project.ProjectRecordBatch.innerNext():93\n    org.apache.drill.exec.record.AbstractRecordBatch.next():160\n    org.apache.drill.exec.record.AbstractRecordBatch.next():109\n    org.apache.drill.exec.record.AbstractRecordBatch.next():101\n    org.apache.drill.exec.physical.impl.aggregate.HashAggBatch.buildSchema():246\n    org.apache.drill.exec.record.AbstractRecordBatch.next():143\n    org.apache.drill.exec.record.AbstractRecordBatch.next():109\n    org.apache.drill.exec.record.AbstractRecordBatch.next():101\n    org.apache.drill.exec.record.AbstractUnaryRecordBatch.innerNext():59\n    org.apache.drill.exec.physical.impl.limit.LimitRecordBatch.innerNext():68\n    org.apache.drill.exec.record.AbstractRecordBatch.next():160\n    org.apache.drill.exec.record.AbstractRecordBatch.next():109\n    org.apache.drill.exec.record.AbstractRecordBatch.next():101\n    org.apache.drill.exec.record.AbstractUnaryRecordBatch.innerNext():59\n    org.apache.drill.exec.record.AbstractRecordBatch.next():160\n    org.apache.drill.exec.record.AbstractRecordBatch.next():109\n    org.apache.drill.exec.record.AbstractRecordBatch.next():101\n    org.apache.drill.exec.record.AbstractUnaryRecordBatch.innerNext():59\n    org.apache.drill.exec.physical.impl.project.ProjectRecordBatch.innerNext():93\n    org.apache.drill.exec.record.AbstractRecordBatch.next():160\n    org.apache.drill.exec.physical.impl.BaseRootExec.next():103\n    org.apache.drill.exec.physical.impl.ScreenCreator$ScreenRoot.innerNext():81\n    org.apache.drill.exec.physical.impl.BaseRootExec.next():93\n    org.apache.drill.exec.work.fragment.FragmentExecutor.lambda$run$0():321\n    .......():0\n    org.apache.hadoop.security.UserGroupInformation.doAs():1762\n    org.apache.drill.exec.work.fragment.FragmentExecutor.run():310\n    org.apache.drill.common.SelfCleaningRunnable.run():38\n    .......():0\n","errorId":"b84a7dcc-7ece-477f-975f-7737ac43ca0b","optionsJson":"[ {\n  \"kind\" : \"BOOLEAN\",\n  \"accessibleScopes\" : \"ALL\",\n  \"name\" : \"planner.enable_file_listing_limit0_optimization\",\n  \"bool_val\" : false,\n  \"scope\" : \"QUERY\"\n} ]","planEnd":1738490027213,"queueWaitEnd":1738490027213,"totalCost":201321.875,"queueName":"Unknown","queryId":"1860bf55-3b17-df7e-0dae-de99ab0d09c6","scannedPlugins":["mongo"]}