[2025-01-25T10:14:42.899+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:14:42.922+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:14:42.924+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-01-25T10:14:42.969+0000] {taskinstance.py:1350} INFO - Executing <Task(_PythonDecoratedOperator): load_to_mongo> on 2025-01-24 00:00:00+00:00
[2025-01-25T10:14:42.983+0000] {standard_task_runner.py:57} INFO - Started process 142 to run task
[2025-01-25T10:14:42.991+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'airqino_etl_to_mongo', 'load_to_mongo', 'manual__2025-01-24T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/airqino_etl_to_mongo.py', '--cfg-path', '/tmp/tmp1jgpo7d5']
[2025-01-25T10:14:42.998+0000] {standard_task_runner.py:85} INFO - Job 14: Subtask load_to_mongo
[2025-01-25T10:14:43.090+0000] {task_command.py:410} INFO - Running <TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [running]> on host bc5f62e6ab49
[2025-01-25T10:14:43.336+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='airqino_etl_to_mongo' AIRFLOW_CTX_TASK_ID='load_to_mongo' AIRFLOW_CTX_EXECUTION_DATE='2025-01-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-01-24T00:00:00+00:00'
[2025-01-25T10:14:43.389+0000] {etl.py:53} INFO - Loading data to MongoDB collection daily_averages in database air_quality
[2025-01-25T10:15:13.527+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/decorators/base.py", line 220, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/airqino_etl_to_mongo.py", line 27, in load_to_mongo
    load_data_to_mongo(data, "air_quality", "daily_averages")
  File "/opt/airflow/dags/utils/etl.py", line 58, in load_data_to_mongo
    collection.insert_many(data.to_dict(orient='records'))
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/collection.py", line 742, in insert_many
    blk.execute(write_concern, session, _Op.INSERT)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 595, in execute
    return self.execute_command(generator, write_concern, session, operation)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 458, in execute_command
    operation_id=op_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1569, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1500, in _retry_internal
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2347, in run
    return self._read() if self._is_read else self._write()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2450, in _write
    self._server = self._get_server()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2439, in _get_server
    operation_id=self._operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1320, in _select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 374, in select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 347, in _select_server
    selector, operation, server_selection_timeout, address, operation_id
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 254, in select_servers
    selector, server_timeout, operation, operation_id, address
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 304, in _select_servers_loop
    f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794b99350aec9210d64a176, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
[2025-01-25T10:15:13.544+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=airqino_etl_to_mongo, task_id=load_to_mongo, execution_date=20250124T000000, start_date=20250125T101442, end_date=20250125T101513
[2025-01-25T10:15:13.562+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 14 for task load_to_mongo (localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794b99350aec9210d64a176, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>; 142)
[2025-01-25T10:15:13.584+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-01-25T10:15:13.605+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-01-25T10:18:52.349+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:18:52.360+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:18:52.360+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-01-25T10:18:52.378+0000] {taskinstance.py:1350} INFO - Executing <Task(_PythonDecoratedOperator): load_to_mongo> on 2025-01-24 00:00:00+00:00
[2025-01-25T10:18:52.382+0000] {standard_task_runner.py:57} INFO - Started process 134 to run task
[2025-01-25T10:18:52.389+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'airqino_etl_to_mongo', 'load_to_mongo', 'manual__2025-01-24T00:00:00+00:00', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/airqino_etl_to_mongo.py', '--cfg-path', '/tmp/tmpzrjcwm10']
[2025-01-25T10:18:52.390+0000] {standard_task_runner.py:85} INFO - Job 17: Subtask load_to_mongo
[2025-01-25T10:18:52.455+0000] {task_command.py:410} INFO - Running <TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [running]> on host bc5f62e6ab49
[2025-01-25T10:18:52.659+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='airqino_etl_to_mongo' AIRFLOW_CTX_TASK_ID='load_to_mongo' AIRFLOW_CTX_EXECUTION_DATE='2025-01-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-01-24T00:00:00+00:00'
[2025-01-25T10:18:52.718+0000] {etl.py:53} INFO - Loading data to MongoDB collection daily_averages in database air_quality
[2025-01-25T10:19:22.706+0000] {local_task_job_runner.py:299} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2025-01-25T10:19:22.708+0000] {process_utils.py:135} INFO - Sending Signals.SIGTERM to group 134. PIDs of all processes in the group: [134]
[2025-01-25T10:19:22.708+0000] {process_utils.py:86} INFO - Sending the signal Signals.SIGTERM to group 134
[2025-01-25T10:19:22.709+0000] {taskinstance.py:1540} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-01-25T10:19:22.806+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=134, status='terminated', exitcode=0, started='10:18:51') (134) terminated with exit code 0
[2025-01-25T10:22:36.464+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:22:36.474+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:22:36.475+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-01-25T10:22:36.493+0000] {taskinstance.py:1350} INFO - Executing <Task(_PythonDecoratedOperator): load_to_mongo> on 2025-01-24 00:00:00+00:00
[2025-01-25T10:22:36.498+0000] {standard_task_runner.py:57} INFO - Started process 124 to run task
[2025-01-25T10:22:36.502+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'airqino_etl_to_mongo', 'load_to_mongo', 'manual__2025-01-24T00:00:00+00:00', '--job-id', '21', '--raw', '--subdir', 'DAGS_FOLDER/airqino_etl_to_mongo.py', '--cfg-path', '/tmp/tmpq28b1vho']
[2025-01-25T10:22:36.503+0000] {standard_task_runner.py:85} INFO - Job 21: Subtask load_to_mongo
[2025-01-25T10:22:36.579+0000] {task_command.py:410} INFO - Running <TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [running]> on host bc5f62e6ab49
[2025-01-25T10:22:36.780+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='airqino_etl_to_mongo' AIRFLOW_CTX_TASK_ID='load_to_mongo' AIRFLOW_CTX_EXECUTION_DATE='2025-01-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-01-24T00:00:00+00:00'
[2025-01-25T10:22:36.812+0000] {etl.py:53} INFO - Loading data to MongoDB collection daily_averages in database air_quality
[2025-01-25T10:23:06.955+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/decorators/base.py", line 220, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/airqino_etl_to_mongo.py", line 30, in load_to_mongo
    load_data_to_mongo(data, "air_quality", "daily_averages")
  File "/opt/airflow/dags/utils/etl.py", line 58, in load_data_to_mongo
    collection.insert_many(data.to_dict(orient='records'))
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/collection.py", line 742, in insert_many
    blk.execute(write_concern, session, _Op.INSERT)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 595, in execute
    return self.execute_command(generator, write_concern, session, operation)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 458, in execute_command
    operation_id=op_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1569, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1500, in _retry_internal
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2347, in run
    return self._read() if self._is_read else self._write()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2450, in _write
    self._server = self._get_server()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2439, in _get_server
    operation_id=self._operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1320, in _select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 374, in select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 347, in _select_server
    selector, operation, server_selection_timeout, address, operation_id
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 254, in select_servers
    selector, server_timeout, operation, operation_id, address
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 304, in _select_servers_loop
    f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794bb6c5fd50447b1a00500, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
[2025-01-25T10:23:06.972+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=airqino_etl_to_mongo, task_id=load_to_mongo, execution_date=20250124T000000, start_date=20250125T102236, end_date=20250125T102306
[2025-01-25T10:23:06.985+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 21 for task load_to_mongo (localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794bb6c5fd50447b1a00500, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>; 124)
[2025-01-25T10:23:07.014+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-01-25T10:23:07.034+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-01-25T10:49:08.563+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:49:08.573+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:49:08.574+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-01-25T10:49:08.589+0000] {taskinstance.py:1350} INFO - Executing <Task(_PythonDecoratedOperator): load_to_mongo> on 2025-01-24 00:00:00+00:00
[2025-01-25T10:49:08.594+0000] {standard_task_runner.py:57} INFO - Started process 457 to run task
[2025-01-25T10:49:08.598+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'airqino_etl_to_mongo', 'load_to_mongo', 'manual__2025-01-24T00:00:00+00:00', '--job-id', '34', '--raw', '--subdir', 'DAGS_FOLDER/airqino_etl_to_mongo.py', '--cfg-path', '/tmp/tmpav67q120']
[2025-01-25T10:49:08.599+0000] {standard_task_runner.py:85} INFO - Job 34: Subtask load_to_mongo
[2025-01-25T10:49:08.662+0000] {task_command.py:410} INFO - Running <TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [running]> on host bc5f62e6ab49
[2025-01-25T10:49:08.857+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='airqino_etl_to_mongo' AIRFLOW_CTX_TASK_ID='load_to_mongo' AIRFLOW_CTX_EXECUTION_DATE='2025-01-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-01-24T00:00:00+00:00'
[2025-01-25T10:49:08.889+0000] {etl.py:53} INFO - Loading data to MongoDB collection daily_averages in database air_quality
[2025-01-25T10:49:39.025+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/decorators/base.py", line 220, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/airqino_etl_to_mongo.py", line 32, in load_to_mongo
    load_data_to_mongo(data, "air_quality", "daily_averages")
  File "/opt/airflow/dags/utils/etl.py", line 58, in load_data_to_mongo
    collection.insert_many(data.to_dict(orient='records'))
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/collection.py", line 742, in insert_many
    blk.execute(write_concern, session, _Op.INSERT)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 595, in execute
    return self.execute_command(generator, write_concern, session, operation)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 458, in execute_command
    operation_id=op_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1569, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1500, in _retry_internal
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2347, in run
    return self._read() if self._is_read else self._write()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2450, in _write
    self._server = self._get_server()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2439, in _get_server
    operation_id=self._operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1320, in _select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 374, in select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 347, in _select_server
    selector, operation, server_selection_timeout, address, operation_id
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 254, in select_servers
    selector, server_timeout, operation, operation_id, address
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 304, in _select_servers_loop
    f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794c1a443e4edd8b2204253, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
[2025-01-25T10:49:39.040+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=airqino_etl_to_mongo, task_id=load_to_mongo, execution_date=20250124T000000, start_date=20250125T104908, end_date=20250125T104939
[2025-01-25T10:49:39.053+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 34 for task load_to_mongo (localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794c1a443e4edd8b2204253, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>; 457)
[2025-01-25T10:49:39.081+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-01-25T10:49:39.102+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-01-25T10:51:33.904+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:51:33.915+0000] {taskinstance.py:1125} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [queued]>
[2025-01-25T10:51:33.915+0000] {taskinstance.py:1331} INFO - Starting attempt 1 of 1
[2025-01-25T10:51:33.932+0000] {taskinstance.py:1350} INFO - Executing <Task(_PythonDecoratedOperator): load_to_mongo> on 2025-01-24 00:00:00+00:00
[2025-01-25T10:51:33.936+0000] {standard_task_runner.py:57} INFO - Started process 649 to run task
[2025-01-25T10:51:33.940+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'airqino_etl_to_mongo', 'load_to_mongo', 'manual__2025-01-24T00:00:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/airqino_etl_to_mongo.py', '--cfg-path', '/tmp/tmpr1ra9vjj']
[2025-01-25T10:51:33.942+0000] {standard_task_runner.py:85} INFO - Job 39: Subtask load_to_mongo
[2025-01-25T10:51:34.011+0000] {task_command.py:410} INFO - Running <TaskInstance: airqino_etl_to_mongo.load_to_mongo manual__2025-01-24T00:00:00+00:00 [running]> on host bc5f62e6ab49
[2025-01-25T10:51:34.204+0000] {taskinstance.py:1570} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='airqino_etl_to_mongo' AIRFLOW_CTX_TASK_ID='load_to_mongo' AIRFLOW_CTX_EXECUTION_DATE='2025-01-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-01-24T00:00:00+00:00'
[2025-01-25T10:51:34.235+0000] {etl.py:53} INFO - Loading data to MongoDB collection daily_averages in database air_quality
[2025-01-25T10:52:04.370+0000] {taskinstance.py:1847} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/decorators/base.py", line 220, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/airqino_etl_to_mongo.py", line 32, in load_to_mongo
    load_data_to_mongo(data, "air_quality", "daily_averages")
  File "/opt/airflow/dags/utils/etl.py", line 58, in load_data_to_mongo
    collection.insert_many(data.to_dict(orient='records'))
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/collection.py", line 742, in insert_many
    blk.execute(write_concern, session, _Op.INSERT)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 595, in execute
    return self.execute_command(generator, write_concern, session, operation)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/bulk.py", line 458, in execute_command
    operation_id=op_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1569, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1500, in _retry_internal
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2347, in run
    return self._read() if self._is_read else self._write()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2450, in _write
    self._server = self._get_server()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 2439, in _get_server
    operation_id=self._operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1320, in _select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 374, in select_server
    operation_id=operation_id,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 347, in _select_server
    selector, operation, server_selection_timeout, address, operation_id
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 254, in select_servers
    selector, server_timeout, operation, operation_id, address
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/topology.py", line 304, in _select_servers_loop
    f"{self._error_message(selector)}, Timeout: {timeout}s, Topology Description: {self.description!r}"
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794c2366916e7ce05b758bf, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>
[2025-01-25T10:52:04.385+0000] {taskinstance.py:1373} INFO - Marking task as FAILED. dag_id=airqino_etl_to_mongo, task_id=load_to_mongo, execution_date=20250124T000000, start_date=20250125T105133, end_date=20250125T105204
[2025-01-25T10:52:04.404+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 39 for task load_to_mongo (localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 30s, Topology Description: <TopologyDescription id: 6794c2366916e7ce05b758bf, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>; 649)
[2025-01-25T10:52:04.447+0000] {local_task_job_runner.py:232} INFO - Task exited with return code 1
[2025-01-25T10:52:04.469+0000] {taskinstance.py:2674} INFO - 0 downstream tasks scheduled from follow-on schedule check
